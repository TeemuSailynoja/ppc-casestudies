{
  "hash": "18a25d863f7f26a811e3d75aa5d32d6a",
  "result": {
    "markdown": "---\ntitle: \"\"\nsubtitle: \"\"\nauthor: \"Teemu SÃ¤ilynoja\"\ndate: \"2023-02-22\"\ndate-modified: \"2023-02-28\"\n# image: \"../../docs/case_studies/\"\nformat:\n  html:\n    page-layout: full\n    toc: true\n    code-fold: true\n    code-tools: true\n    code-line-numbers: true\n    default-image-extension: svg\n    fig-format: svg\nexecute: \n  cache: true\nknitr:\n  opts_chunk:\n    autodep: true\n---\n\n::: {.cell hash='roaches_cache/html/unnamed-chunk-1_5238dcca8f3d3715395fb8c3de379126'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(bayesplot)\nlibrary(cmdstanr)\nlibrary(loo)\nlibrary(rstanarm)\nlibrary(rstantools)\n\nsource(\"../../code/helpers.R\")\n\nSEED = 1238761243\nset.seed(SEED)\n```\n:::\n\n\n# Data\n\n\n::: {.cell hash='roaches_cache/html/data wrangling_22d92f020cc4d36ac0c6417a4138f206'}\n\n```{.r .cell-code}\nroaches$id <- 1:dim(roaches)[1]\nroaches$sqrt_roach1 <- sqrt(roaches$roach1)\n```\n:::\n\n\n# Stan Model\n\n\n::: {.cell hash='roaches_cache/html/model_091ab55ad79986e9711a8046ad2b1469'}\n\n```{.r .cell-code}\n(m_glmpr <-\n      cmdstan_model(stan_file = \"../../code/stan-models/roaches_poisson_re_loo.stan\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n// Poisson regression with hierarchical intercept (\"random effect\")\nfunctions {\n  real integrand(real z, real notused, array[] real theta,\n               array[] real Xi, array[] int yi) {\n    real sigmaz = theta[1];\n    real offsetti_plus_alpha = theta[2];\n    int ntheta = num_elements(theta);\n    vector[ntheta-2] beta = to_vector(theta[3:ntheta]);\n    return exp(normal_lpdf(z|0,sigmaz)+poisson_log_glm_lpmf(yi | to_row_vector(Xi), z+offsetti_plus_alpha, beta));\n  }\n}\ndata {\n  int<lower=0> N;           // number of data points\n  int<lower=0> P;           // number of covariates\n  matrix[N,P] X;            // covariates\n  array[N] int<lower=0> y;  // target\n  vector[N] offsett;        // offset (offset variable name is reserved)\n}\nparameters {\n  real alpha;               // intercept\n  vector[P] beta;           // slope\n  vector[N] z;              // individual intercept (\"random effect\")\n  real<lower=0> sigmaz;     // prior scale for z\n}\nmodel {\n  // priors\n  alpha ~ normal(0, 3);\n  beta ~ normal(0, 3);\n  z ~ normal(0, sigmaz);\n  sigmaz ~ normal(0, 1);\n  // observation model\n  y ~ poisson_log_glm(X, z+offsett+alpha, beta);\n}\ngenerated quantities {\n  // log_lik for PSIS-LOO\n  vector[N] log_lik;\n  vector[N] yrep;\n  vector[N] yrep2;\n  {\n    real z2;\n  for (i in 1:N) {\n    // z as posterior draws, this would be challenging for PSIS-LOO (and WAIC)\n    // log_lik[i] = poisson_log_glm_lpmf({y[i]} | X[i,], z[i]+offsett[i]+alpha, beta);\n    // we can integrate each z[i] iut with 1D adaptive quadrature\n    log_lik[i] = log(integrate_1d(integrand,\n                              negative_infinity(),\n                              positive_infinity(),\n                              append_array({sigmaz}, append_array({offsett[i]+alpha}, to_array_1d(beta))),\n                  to_array_1d(X[i,]),\n                  {y[i]}));\n    yrep[i] = poisson_log_rng(z[i]+offsett[i]+alpha+X[i,]*beta);\n    z2 = normal_rng(0, sigmaz);\n    yrep2[i] = poisson_log_rng(z2+offsett[i]+alpha+X[i,]*beta);\n  }\n  }\n}\n```\n:::\n\n```{.r .cell-code}\nf_glmpr <- tryCatch(\n  read_cmdstan_csv(files = paste(\n    \"../../code/stan-models/fits/\",\n    list.files(\"../../code/stan-models/fits/\",\n               pattern = cat(\"roaches_glmpr_\", SEED, sep = \"\")),\n    sep = \"\"\n  )), error = function(e) {\n    datap <- list(\n      N = dim(roaches)[1],\n      P = 3,\n      offsett = log(roaches$exposure2),\n      X = roaches[, c('sqrt_roach1', 'treatment', 'senior')],\n      y = roaches$y\n    )\n    m_glmpr$sample(\n      data = datap,\n      refresh = 0,\n      chains = 8,\n      parallel_chains = 4,\n      seed = SEED,\n      output_dir = \"../../code/stan-models/fits\",\n      output_basename = cat(\"roaches_glmpr_\", SEED, sep = \"\")\n    )\n  },\n  finally = {\n  }\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nroaches_glmpr_1238761243roaches_glmpr_1238761243Running MCMC with 8 chains, at most 4 in parallel...\n\nChain 3 Exception: integrate: error estimate of integral 3.44774e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 3 Exception: integrate: error estimate of integral 3.44774e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 3 Exception: integrate: error estimate of integral 2.29561e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 3 Exception: integrate: error estimate of integral 2.29561e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.00617e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.00617e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 4.53476e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 4.53476e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 2.88488e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 2.88488e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 7.71167e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 7.71167e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.06912e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.06912e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 2.15529e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 2.15529e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 1.91073e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 1.91073e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 3 Exception: integrate: error estimate of integral 1.33764e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 3 Exception: integrate: error estimate of integral 1.33764e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.23331e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.23331e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.24438e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.24438e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 3.98042e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 3.98042e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.45086e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.45086e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 2.22431e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 2.22431e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 6.03652e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 6.03652e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 4.60036e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 4.60036e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 4.36798e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 4.36798e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 2.54266e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 2.54266e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 1.78576e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 1.78576e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 1.31364e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 1.31364e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 5.68003e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 5.68003e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 2.87275e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 2.87275e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 4.94643e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 4.94643e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 4 Exception: integrate: error estimate of integral 4.60403e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 4 Exception: integrate: error estimate of integral 4.60403e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 4 Exception: integrate: error estimate of integral 1.18872e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 4 Exception: integrate: error estimate of integral 1.18872e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 4 Exception: integrate: error estimate of integral 3.84996e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 4 Exception: integrate: error estimate of integral 3.84996e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 4 Exception: integrate: error estimate of integral 1.45303e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 4 Exception: integrate: error estimate of integral 1.45303e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 3 Exception: integrate: error estimate of integral 2.90464e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 3 Exception: integrate: error estimate of integral 2.90464e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.33576e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.33576e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.96228e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.96228e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.24439e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.24439e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.6454e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.6454e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 2.94165e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 2.94165e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.6434e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.6434e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 2.19219e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 2.19219e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 2.40757e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 2.40757e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 3 Exception: integrate: error estimate of integral 2.00546e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 3 Exception: integrate: error estimate of integral 2.00546e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 1.19089e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 1.19089e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 6.84552e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 6.84552e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 2.02872e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 2.02872e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 2 Exception: integrate: error estimate of integral 5.10269e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 2 Exception: integrate: error estimate of integral 5.10269e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 3.11995e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 3.11995e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 3.93965e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 3.93965e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 2.34738e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 2.34738e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 1.31718e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 1.31718e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 3.36676e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 3.36676e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 8.32388e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 8.32388e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 1 Exception: integrate: error estimate of integral 4.35297e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 1 Exception: integrate: error estimate of integral 4.35297e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 3 finished in 76.7 seconds.\nChain 1 finished in 78.8 seconds.\nChain 4 finished in 79.7 seconds.\nChain 2 finished in 80.7 seconds.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 29, column 2 to column 24)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 8 Exception: integrate: error estimate of integral 1.82359e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 Exception: integrate: error estimate of integral 1.82359e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 3.06037e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 3.06037e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 2.38468e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 2.38468e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 2.46563e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 2.46563e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 6.05173e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 6.05173e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 8 Exception: integrate: error estimate of integral 2.39815e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 Exception: integrate: error estimate of integral 2.39815e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 8.3649e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 8.3649e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 1.98161e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 1.98161e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 1.45751e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 1.45751e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 4.76558e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 4.76558e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 3.85231e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 3.85231e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 2.30694e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 2.30694e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 3.35429e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 3.35429e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 4.01209e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 4.01209e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 3.74663e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 3.74663e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 4.60184e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 4.60184e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 1.44995e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 1.44995e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 1.8636e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 1.8636e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 5 Exception: integrate: error estimate of integral 2.75953e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 5 Exception: integrate: error estimate of integral 2.75953e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 3.76076e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 3.76076e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 7.09143e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 7.09143e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 2.31288e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 2.31288e-12 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 5 Exception: integrate: error estimate of integral 2.32492e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 5 Exception: integrate: error estimate of integral 2.32492e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 5 Exception: integrate: error estimate of integral 8.26722e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 5 Exception: integrate: error estimate of integral 8.26722e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 8 Exception: integrate: error estimate of integral 2.09788e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 Exception: integrate: error estimate of integral 2.09788e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 8 Exception: integrate: error estimate of integral 3.06475e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 8 Exception: integrate: error estimate of integral 3.06475e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 5 Exception: integrate: error estimate of integral 3.5989e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 5 Exception: integrate: error estimate of integral 3.5989e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 5 Exception: integrate: error estimate of integral 5.7324e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 5 Exception: integrate: error estimate of integral 5.7324e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 Exception: integrate: error estimate of integral 2.08525e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 6 Exception: integrate: error estimate of integral 2.08525e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 9.6825e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 9.6825e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 2.76437e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 2.76437e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 5.89961e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 5.89961e-14 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 1.65447e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 1.65447e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 3.68058e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 3.68058e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 5 finished in 83.1 seconds.\nChain 7 Exception: integrate: error estimate of integral 2.69904e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 2.69904e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 8 finished in 79.4 seconds.\nChain 7 Exception: integrate: error estimate of integral 9.02036e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 9.02036e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 Exception: integrate: error estimate of integral 6.2527e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 6.2527e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 6 finished in 81.4 seconds.\nChain 7 Exception: integrate: error estimate of integral 1.35082e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27) \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nChain 7 Exception: integrate: error estimate of integral 1.35082e-13 exceeds the given relative tolerance times norm of integral (in '/tmp/RtmpcpDMFk/model-1da855091f076.stan', line 45, column 4 to line 50, column 27)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nChain 7 finished in 82.0 seconds.\n\nAll 8 chains finished successfully.\nMean chain execution time: 80.2 seconds.\nTotal execution time: 162.0 seconds.\n```\n:::\n:::\n\n::: {.cell hash='roaches_cache/html/unnamed-chunk-4_6a8792eab6dcd73ba7861fb4b5af674d'}\n\n```{.r .cell-code}\n(loo_glmpr <- f_glmpr$loo(save_psis = T, chains = 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nComputed from 8000 by 262 log-likelihood matrix\n\n         Estimate   SE\nelpd_loo   -876.1 38.2\np_loo       189.9 16.3\nlooic      1752.2 76.3\n------\nMonte Carlo SE of elpd_loo is 0.1.\n\nAll Pareto k estimates are good (k < 0.5).\nSee help('pareto-k-diagnostic') for details.\n```\n:::\n\n```{.r .cell-code}\npsis <- loo_glmpr$psis_object\nlw <- weights(psis)\n\npit_loo <- rstantools::loo_pit(object = f_glmpr$draws(\"yrep\", format = \"matrix\"), y = roaches$y, lw = lw)\n```\n:::\n\n::: {.cell hash='roaches_cache/html/unnamed-chunk-5_ee0296b32be8cd2c6e27c85f9634f8a7'}\n\n```{.r .cell-code}\n(p1 <- ppc_pit_ecdf(pit = pit_loo))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n'pit' specified so ignoring 'y', and 'yrep' if specified.\n```\n:::\n\n::: {.cell-output-display}\n![](roaches_files/figure-html/unnamed-chunk-5-1.svg)\n:::\n:::\n\n::: {.cell hash='roaches_cache/html/unnamed-chunk-6_f3b3fc2a56268375280459d33ef22c67'}\n\n```{.r .cell-code}\npit_loo_2 <- rstantools::loo_pit(object = f_glmpr$draws(\"yrep2\", format = \"matrix\"), y = roaches$y, lw = lw)\n```\n:::\n\n::: {.cell hash='roaches_cache/html/unnamed-chunk-7_a5a7849fb6aee3475c171e3703d45717'}\n\n```{.r .cell-code}\n(p2 <- ppc_pit_ecdf(pit = pit_loo_2, plot_diff = T))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n'pit' specified so ignoring 'y', and 'yrep' if specified.\n```\n:::\n\n::: {.cell-output-display}\n![](roaches_files/figure-html/unnamed-chunk-7-1.svg)\n:::\n:::\n\n::: {.cell hash='roaches_cache/html/unnamed-chunk-8_2b61473d5b57c76e5952854855ba147b'}\n\n```{.r .cell-code}\nppc_pit_ecdf(pit = pit_loo_2[roaches$y != 0])\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n'pit' specified so ignoring 'y', and 'yrep' if specified.\n```\n:::\n\n::: {.cell-output-display}\n![](roaches_files/figure-html/unnamed-chunk-8-1.svg)\n:::\n:::\n\n\n# Original Computing Environment {.unnumbered} \n\n::: {.cell hash='roaches_cache/html/unnamed-chunk-9_602dea1d0a3670366f7cdd3f00d86413'}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.2.2 Patched (2022-11-10 r83330)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=fi_FI.UTF-8        LC_COLLATE=en_GB.UTF-8    \n [5] LC_MONETARY=fi_FI.UTF-8    LC_MESSAGES=en_GB.UTF-8   \n [7] LC_PAPER=fi_FI.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=fi_FI.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] rstantools_2.1.1      khroma_1.9.0          ggdist_3.2.1         \n [4] reliabilitydiag_0.2.0 rstanarm_2.21.1       Rcpp_1.0.10          \n [7] loo_2.4.1             cmdstanr_0.5.0        bayesplot_1.10.0     \n[10] ggplot2_3.4.1        \n\nloaded via a namespace (and not attached):\n [1] nlme_3.1-161         matrixStats_0.63.0   xts_0.12.1          \n [4] threejs_0.3.3        rstan_2.21.8         tensorA_0.36.2      \n [7] tools_4.2.2          backports_1.4.1      utf8_1.2.3          \n[10] R6_2.5.1             DT_0.27              DBI_1.1.3           \n[13] colorspace_2.1-0     withr_2.5.0          tidyselect_1.2.0    \n[16] gridExtra_2.3        prettyunits_1.1.1    processx_3.5.3      \n[19] compiler_4.2.2       cli_3.6.0            shinyjs_2.0.0       \n[22] labeling_0.4.2       colourpicker_1.1.1   posterior_1.3.1     \n[25] scales_1.2.1         dygraphs_1.1.1.6     checkmate_2.1.0     \n[28] callr_3.7.0          stringr_1.5.0        digest_0.6.31       \n[31] StanHeaders_2.21.0-7 minqa_1.2.4          rmarkdown_2.20      \n[34] base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.5.4     \n[37] lme4_1.1-27.1        fastmap_1.1.0        htmlwidgets_1.6.1   \n[40] rlang_1.0.6          rstudioapi_0.14      shiny_1.7.4         \n[43] farver_2.1.1         generics_0.1.3       zoo_1.8-11          \n[46] jsonlite_1.8.4       crosstalk_1.2.0      gtools_3.9.2        \n[49] dplyr_1.1.0          distributional_0.3.1 inline_0.3.19       \n[52] magrittr_2.0.3       Matrix_1.5-3         munsell_0.5.0       \n[55] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     \n[58] stringi_1.7.12       yaml_2.3.7           MASS_7.3-58         \n[61] pkgbuild_1.2.1       plyr_1.8.8           grid_4.2.2          \n[64] parallel_4.2.2       promises_1.2.0.1     crayon_1.5.2        \n[67] miniUI_0.1.1.1       lattice_0.20-45      splines_4.2.2       \n[70] knitr_1.42           ps_1.6.0             pillar_1.8.1        \n[73] igraph_1.3.5         boot_1.3-28          markdown_1.1        \n[76] shinystan_2.6.0      reshape2_1.4.4       codetools_0.2-18    \n[79] stats4_4.2.2         glue_1.6.2           evaluate_0.20       \n[82] data.table_1.14.6    RcppParallel_5.1.4   nloptr_1.2.2.3      \n[85] vctrs_0.5.2          httpuv_1.6.8         gtable_0.3.1        \n[88] xfun_0.37            mime_0.12            xtable_1.8-4        \n[91] later_1.3.0          survival_3.4-0       tibble_3.1.8        \n[94] shinythemes_1.2.0    ellipsis_0.3.2      \n```\n:::\n:::\n\n::: {.cell hash='roaches_cache/html/pit_f275f639f94343ecc60c2de363e6041c'}\n\n```{.r .cell-code}\npl <- rowSums(apply(f_glmpr$draws(\"yrep2\", format = \"matrix\"), 1, \"<\",roaches$y))\npu <- rowSums(apply(f_glmpr$draws(\"yrep2\", format = \"matrix\"), 1, \"<=\",roaches$y))\n\npit <- sapply(1:nrow(roaches), function(i) sample(pl[i]:pu[i], 1)) / (f_glmpr$metadata()$iter_sampling * 8)\n```\n:::\n\n::: {.cell hash='roaches_cache/html/ecdf_plot_6bde0f55f9e7849020801c84beda5aa7'}\n\n```{.r .cell-code}\np <- ppc_pit_ecdf(pit = pit)\np + geom_mark_suspicions(p)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in pbinom(q = growth(llag) - 1, size = size(llag), prob = pr(llag), :\nNaNs produced\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in pbinom(q = growth(llag_down), size = size(llag_down), prob =\npr(llag_down), : NaNs produced\n```\n:::\n\n::: {.cell-output-display}\n![](roaches_files/figure-html/ecdf_plot-1.svg)\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}